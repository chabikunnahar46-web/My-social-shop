<!DOCTYPE html>
<html>
<head>
<title>Bondhutto24</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js"></script>

<script type="module">
import { auth, db } from './firebase.js';
import { collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

// USER CHECK
auth.onAuthStateChanged(user => {
  if (!user) window.location.href = "login.html";
});

// FEED LOAD
async function loadFeed() {
  const feed = document.getElementById("feed");
  feed.innerHTML = "";

  const snap = await getDocs(query(collection(db, "posts"), orderBy("createdAt", "desc")));

  snap.forEach(doc => {
    const p = doc.data();

    feed.innerHTML += `
      <div class='post'>
        <h3>${p.userName}</h3>
        <p>${p.caption}</p>

        <button onclick="likePost('${doc.id}')">‚ù§Ô∏è Like</button>
        <button onclick="commentPost('${doc.id}')">üí¨ Comment</button>
      </div>
      <hr>
    `;
  });
}

window.onload = loadFeed;

// LIKE Function
window.likePost = async (id) => {
  alert("Like ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶õ‡ßá! (‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶° ‡¶ï‡¶∞‡ßá ‡¶¶‡¶ø‡¶¨)");
};

// COMMENT Function
window.commentPost = (id) => {
  alert("Comment ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶õ‡ßá!");
};

</script>

<style>
.post{
  background:#eee;
  padding:10px;
  border-radius:10px;
  margin-bottom:10px;
}
</style>

</head>

<body>

<h2>Bondhutto24</h2>
<div id="feed"></div>

</body>
</html>
